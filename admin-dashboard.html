<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Control Room â€” Adrem Model Academy</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --amber:#fbbf24; --amber-deep:#d97706; --amber-light:#fde68a;
    --amber-bg:rgba(251,191,36,0.1); --amber-b:rgba(251,191,36,0.25);
    --purple:#7c52e8; --purple-deep:#5236c7; --purple-light:#b8a4f7;
    --purple-bg:rgba(124,82,232,0.1); --purple-b:rgba(124,82,232,0.25);
    --rose:#e8527a; --rose-deep:#c73660; --rose-light:#f7a8bf;
    --rose-bg:rgba(232,82,122,0.1); --rose-b:rgba(232,82,122,0.25);
    --charcoal:#1a1626; --charcoal-2:#231d33; --muted:#9c8fa3; --white:#ffffff;
    --glass:rgba(255,255,255,0.06); --glass-b:rgba(255,255,255,0.11);
    --green:#4ade80; --green-bg:rgba(74,222,128,0.1); --green-b:rgba(74,222,128,0.25);
    --red:#f87171; --red-bg:rgba(248,113,113,0.1); --red-b:rgba(248,113,113,0.25);
    --blue:#60a5fa; --blue-bg:rgba(96,165,250,0.1); --blue-b:rgba(96,165,250,0.25);
  }
  *,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
  html{scroll-behavior:smooth;}
  body{font-family:'DM Sans',sans-serif;background:var(--charcoal);color:var(--white);min-height:100vh;display:flex;}

  /* SIDEBAR */
  .sidebar{width:250px;min-width:250px;background:var(--charcoal-2);border-right:1px solid rgba(255,255,255,0.06);display:flex;flex-direction:column;padding:24px 0;position:fixed;top:0;left:0;bottom:0;z-index:50;transition:transform 0.3s;overflow-y:auto;}
  .sidebar-logo{display:flex;align-items:center;gap:12px;padding:0 20px 24px;border-bottom:1px solid rgba(255,255,255,0.06);margin-bottom:20px;}
  .s-logo-icon{width:40px;height:40px;background:linear-gradient(135deg,var(--amber),var(--amber-deep));border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;}
  .s-logo-text{font-family:'Playfair Display',serif;font-size:0.82rem;font-weight:700;line-height:1.3;}
  .s-logo-text span{display:block;font-family:'DM Sans',sans-serif;font-size:0.62rem;color:var(--amber-light);letter-spacing:1.5px;text-transform:uppercase;font-weight:400;}
  .nav-section{padding:0 12px;margin-bottom:6px;}
  .nav-label{font-size:0.62rem;color:var(--muted);text-transform:uppercase;letter-spacing:2px;padding:0 10px;margin-bottom:5px;}
  .nav-item{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:10px;color:var(--muted);font-size:0.85rem;font-weight:500;transition:all 0.2s;cursor:pointer;border:none;background:none;width:100%;text-align:left;}
  .nav-item:hover{background:rgba(255,255,255,0.05);color:var(--white);}
  .nav-item.active{background:rgba(251,191,36,0.15);color:var(--amber-light);}
  .nav-item .ni{font-size:0.95rem;width:18px;text-align:center;}
  .sidebar-bottom{margin-top:auto;padding:16px 12px 0;border-top:1px solid rgba(255,255,255,0.06);}
  .logout-btn{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:10px;color:var(--muted);font-size:0.85rem;text-decoration:none;transition:all 0.2s;cursor:pointer;}
  .logout-btn:hover{color:var(--red);background:var(--red-bg);}

  /* MAIN */
  .main{margin-left:250px;flex:1;display:flex;flex-direction:column;min-height:100vh;}
  .topbar{position:sticky;top:0;z-index:40;background:rgba(26,22,38,0.97);backdrop-filter:blur(16px);border-bottom:1px solid rgba(255,255,255,0.06);padding:14px 32px;display:flex;align-items:center;justify-content:space-between;}
  .topbar-left h2{font-family:'Playfair Display',serif;font-size:1.15rem;font-weight:700;}
  .topbar-left p{font-size:0.75rem;color:var(--muted);margin-top:2px;}
  .topbar-right{display:flex;align-items:center;gap:10px;}
  .admin-badge{background:var(--amber-bg);border:1px solid var(--amber-b);border-radius:50px;padding:5px 14px;font-size:0.75rem;color:var(--amber-light);}
  .admin-avatar{width:36px;height:36px;background:linear-gradient(135deg,var(--amber),var(--amber-deep));border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.82rem;font-weight:700;color:#1a1626;cursor:pointer;}
  .content{padding:28px 32px;flex:1;}

  /* REUSABLES */
  .stat-row{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:24px;}
  .stat-card{background:var(--glass);border:1px solid var(--glass-b);border-radius:16px;padding:18px;backdrop-filter:blur(8px);transition:all 0.3s;}
  .stat-card:hover{transform:translateY(-3px);}
  .stat-card .sc-icon{font-size:1.4rem;margin-bottom:10px;}
  .stat-card .sc-val{font-family:'Playfair Display',serif;font-size:1.5rem;font-weight:700;margin-bottom:3px;}
  .stat-card .sc-lbl{font-size:0.72rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px;}
  .stat-card.amber{border-color:var(--amber-b);background:var(--amber-bg);} .stat-card.amber .sc-val{color:var(--amber);}
  .stat-card.green{border-color:var(--green-b);background:var(--green-bg);} .stat-card.green .sc-val{color:var(--green);}
  .stat-card.purple{border-color:var(--purple-b);background:var(--purple-bg);} .stat-card.purple .sc-val{color:var(--purple-light);}
  .stat-card.rose{border-color:var(--rose-b);background:var(--rose-bg);} .stat-card.rose .sc-val{color:var(--rose-light);}
  .stat-card.blue{border-color:var(--blue-b);background:var(--blue-bg);} .stat-card.blue .sc-val{color:var(--blue);}
  .stat-card.red{border-color:var(--red-b);background:var(--red-bg);} .stat-card.red .sc-val{color:var(--red);}

  .two-col{display:grid;grid-template-columns:1fr 1fr;gap:18px;margin-bottom:20px;}
  .three-col{display:grid;grid-template-columns:1fr 1fr 1fr;gap:18px;margin-bottom:20px;}
  .section-card{background:var(--glass);border:1px solid var(--glass-b);border-radius:18px;padding:22px;backdrop-filter:blur(8px);}
  .section-card-full{background:var(--glass);border:1px solid var(--glass-b);border-radius:18px;padding:22px;backdrop-filter:blur(8px);margin-bottom:20px;}
  .sc-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;flex-wrap:wrap;gap:10px;}
  .sc-header h3{font-family:'Playfair Display',serif;font-size:0.95rem;font-weight:700;}
  .sc-header span{font-size:0.72rem;color:var(--muted);}

  .btn{padding:8px 18px;border:none;border-radius:10px;font-family:'DM Sans',sans-serif;font-size:0.82rem;font-weight:600;cursor:pointer;transition:all 0.3s;}
  .btn:hover{transform:translateY(-2px);filter:brightness(1.1);}
  .btn-amber{background:linear-gradient(135deg,var(--amber),var(--amber-deep));color:#1a1626;box-shadow:0 4px 14px rgba(251,191,36,0.35);}
  .btn-purple{background:linear-gradient(135deg,var(--purple),var(--purple-deep));color:white;box-shadow:0 4px 14px rgba(124,82,232,0.35);}
  .btn-rose{background:linear-gradient(135deg,var(--rose),var(--rose-deep));color:white;box-shadow:0 4px 14px rgba(232,82,122,0.35);}
  .btn-green{background:linear-gradient(135deg,var(--green),#22c55e);color:#1a1626;box-shadow:0 4px 14px rgba(74,222,128,0.35);}
  .btn-red{background:linear-gradient(135deg,var(--red),#ef4444);color:white;box-shadow:0 4px 14px rgba(248,113,113,0.35);}
  .btn-sm{padding:5px 12px;font-size:0.75rem;border-radius:8px;}

  .data-table{width:100%;border-collapse:collapse;}
  .data-table th{font-size:0.7rem;text-transform:uppercase;letter-spacing:1px;color:var(--muted);text-align:left;padding:0 12px 10px;font-weight:500;}
  .data-table td{padding:11px 12px;border-top:1px solid rgba(255,255,255,0.05);font-size:0.83rem;vertical-align:middle;}
  .data-table tr:hover td{background:rgba(255,255,255,0.03);}
  .actions{display:flex;gap:6px;}

  .badge{display:inline-block;padding:3px 10px;border-radius:50px;font-size:0.7rem;font-weight:600;}
  .badge-green{background:var(--green-bg);color:var(--green);border:1px solid var(--green-b);}
  .badge-amber{background:var(--amber-bg);color:var(--amber);border:1px solid var(--amber-b);}
  .badge-red{background:var(--red-bg);color:var(--red);border:1px solid var(--red-b);}
  .badge-purple{background:var(--purple-bg);color:var(--purple-light);border:1px solid var(--purple-b);}
  .badge-blue{background:var(--blue-bg);color:var(--blue);border:1px solid var(--blue-b);}

  .field{margin-bottom:14px;}
  .field label{display:block;font-size:0.72rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:6px;}
  .field input,.field select,.field textarea{width:100%;padding:10px 14px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.1);border-radius:10px;color:var(--white);font-family:'DM Sans',sans-serif;font-size:0.88rem;outline:none;transition:all 0.3s;}
  .field input:focus,.field select:focus,.field textarea:focus{border-color:var(--amber);background:rgba(251,191,36,0.06);}
  .field select option{background:var(--charcoal-2);}
  .field textarea{resize:vertical;min-height:80px;}
  .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;}

  .perf-item{margin-bottom:12px;}
  .perf-top{display:flex;justify-content:space-between;margin-bottom:5px;font-size:0.8rem;}
  .perf-top strong{color:var(--amber-light);}
  .perf-track{width:100%;height:6px;background:rgba(255,255,255,0.06);border-radius:3px;overflow:hidden;}
  .perf-fill{height:100%;border-radius:3px;}
  .perf-fill.amber{background:linear-gradient(90deg,var(--amber),var(--amber-deep));}
  .perf-fill.green{background:linear-gradient(90deg,#4ade80,#22c55e);}
  .perf-fill.purple{background:linear-gradient(90deg,var(--purple),var(--purple-deep));}
  .perf-fill.red{background:linear-gradient(90deg,var(--red),#ef4444);}
  .perf-fill.blue{background:linear-gradient(90deg,var(--blue),#3b82f6);}

  .activity-list{display:flex;flex-direction:column;gap:10px;}
  .activity-item{display:flex;gap:12px;padding:12px 14px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.06);border-radius:12px;}
  .act-icon{font-size:1.1rem;flex-shrink:0;margin-top:1px;}
  .act-text{flex:1;}
  .act-text strong{display:block;font-size:0.83rem;margin-bottom:2px;}
  .act-text span{font-size:0.75rem;color:var(--muted);}
  .act-time{font-size:0.7rem;color:var(--muted);white-space:nowrap;}

  .notice-list{display:flex;flex-direction:column;gap:10px;margin-bottom:16px;}
  .notice-item{display:flex;align-items:flex-start;gap:12px;padding:12px 14px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);border-radius:12px;}
  .notice-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;margin-top:6px;}
  .notice-dot.urgent{background:var(--red);}
  .notice-dot.normal{background:var(--amber-light);}
  .notice-dot.info{background:var(--blue);}
  .notice-text strong{display:block;font-size:0.83rem;margin-bottom:3px;}
  .notice-text span{font-size:0.75rem;color:var(--muted);line-height:1.5;}

  .class-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px;}
  .class-card{background:var(--glass);border:1px solid var(--glass-b);border-radius:14px;padding:18px;transition:all 0.3s;cursor:pointer;}
  .class-card:hover{transform:translateY(-3px);border-color:var(--amber-b);background:var(--amber-bg);}
  .class-card h4{font-size:0.95rem;font-weight:700;margin-bottom:6px;}
  .class-card .cc-meta{font-size:0.75rem;color:var(--muted);margin-bottom:4px;}
  .class-card .cc-avg{font-family:'Playfair Display',serif;font-size:1.2rem;color:var(--amber);font-weight:700;}

  .score-input{width:55px;padding:5px 6px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.1);border-radius:7px;color:var(--white);font-family:'DM Sans',sans-serif;font-size:0.82rem;text-align:center;outline:none;transition:all 0.3s;}
  .score-input:focus{border-color:var(--amber);background:rgba(251,191,36,0.08);}

  /* â”€â”€ PLAIN BROADSHEET â”€â”€ */
  .broadsheet-table{width:100%;border-collapse:collapse;font-size:0.78rem;}
  .broadsheet-table th{background:rgba(251,191,36,0.12);color:var(--amber-light);font-size:0.65rem;text-transform:uppercase;letter-spacing:1px;padding:10px 8px;text-align:center;border:1px solid rgba(255,255,255,0.08);white-space:nowrap;}
  .broadsheet-table th.name-col{text-align:left;min-width:160px;}
  .broadsheet-table td{padding:9px 8px;border:1px solid rgba(255,255,255,0.05);text-align:center;vertical-align:middle;}
  .broadsheet-table td.name-col{text-align:left;font-weight:500;white-space:nowrap;}
  .broadsheet-table td.pos-col{font-weight:700;color:var(--amber-light);}
  .broadsheet-table tr:hover td{background:rgba(255,255,255,0.03);}
  .broadsheet-table tfoot td{background:rgba(251,191,36,0.08);color:var(--amber-light);font-weight:700;border-top:2px solid rgba(251,191,36,0.25);}

  /* Grade colours */
  .g-A{color:var(--green);font-weight:700;} .g-P{color:var(--amber);font-weight:700;} .g-F{color:var(--red);font-weight:700;}
  .g-A1{color:var(--green);font-weight:700;} .g-B2{color:#34d399;font-weight:700;} .g-B3{color:#6ee7b7;font-weight:700;}
  .g-C4{color:var(--blue);font-weight:700;} .g-C5{color:#93c5fd;font-weight:700;} .g-C6{color:var(--amber);font-weight:700;}
  .g-D7{color:var(--amber-light);font-weight:700;} .g-E8{color:var(--rose-light);font-weight:700;} .g-F9{color:var(--red);font-weight:700;}

  /* Grade key pills */
  .grade-key{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:14px;}
  .gk-item{display:flex;align-items:center;gap:6px;background:var(--glass);border:1px solid var(--glass-b);border-radius:8px;padding:5px 10px;font-size:0.72rem;}

  /* â”€â”€ ANALYSIS CHARTS â”€â”€ */
  .bar-chart{display:flex;align-items:flex-end;gap:8px;height:160px;padding-bottom:24px;position:relative;}
  .bar-chart::before{content:'';position:absolute;left:0;right:0;bottom:24px;top:0;background:repeating-linear-gradient(to top,rgba(255,255,255,0.03) 0px,rgba(255,255,255,0.03) 1px,transparent 1px,transparent 20%);}
  .bar-group{flex:1;display:flex;gap:3px;align-items:flex-end;position:relative;}
  .bar{border-radius:4px 4px 0 0;min-height:4px;transition:height 1s ease;position:relative;cursor:pointer;}
  .bar:hover::after{content:attr(data-val);position:absolute;top:-22px;left:50%;transform:translateX(-50%);background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.15);padding:2px 6px;border-radius:6px;font-size:0.68rem;white-space:nowrap;}
  .bar.ca{background:linear-gradient(to top,var(--purple),rgba(124,82,232,0.5));flex:1;}
  .bar.exam{background:linear-gradient(to top,var(--rose),rgba(232,82,122,0.5));flex:1;}
  .bar-label{position:absolute;bottom:-20px;left:50%;transform:translateX(-50%);font-size:0.6rem;color:var(--muted);white-space:nowrap;text-align:center;width:60px;}
  .chart-legend{display:flex;gap:16px;justify-content:center;margin-top:8px;}
  .legend-item{display:flex;align-items:center;gap:6px;font-size:0.75rem;color:var(--muted);}
  .legend-dot{width:10px;height:10px;border-radius:3px;}

  .donut-wrap{display:flex;align-items:center;gap:24px;}
  .donut-labels{display:flex;flex-direction:column;gap:8px;flex:1;}
  .donut-label{display:flex;align-items:center;gap:8px;font-size:0.78rem;}
  .donut-dot{width:10px;height:10px;border-radius:50%;flex-shrink:0;}
  .donut-label span{color:var(--muted);}
  .donut-label strong{margin-left:auto;}

  .h-bar-item{margin-bottom:12px;}
  .h-bar-top{display:flex;justify-content:space-between;font-size:0.8rem;margin-bottom:5px;}
  .h-bar-top strong{color:var(--white);}
  .h-bar-top span{color:var(--muted);}
  .h-bar-track{width:100%;height:10px;background:rgba(255,255,255,0.06);border-radius:5px;overflow:hidden;position:relative;}
  .h-bar-ca{position:absolute;top:0;left:0;height:100%;border-radius:5px 0 0 5px;background:linear-gradient(90deg,var(--purple),rgba(124,82,232,0.7));}
  .h-bar-exam{position:absolute;top:0;height:100%;background:linear-gradient(90deg,var(--rose),rgba(232,82,122,0.7));}

  /* â”€â”€ PSYCHOMOTOR â”€â”€ */
  .psycho-table{width:100%;border-collapse:collapse;}
  .psycho-table th{font-size:0.68rem;text-transform:uppercase;letter-spacing:1px;color:var(--muted);padding:0 10px 10px;text-align:center;font-weight:500;}
  .psycho-table th:first-child{text-align:left;}
  .psycho-table td{padding:10px;border-top:1px solid rgba(255,255,255,0.05);font-size:0.82rem;text-align:center;}
  .psycho-table td:first-child{text-align:left;font-weight:500;}
  .psycho-select{padding:5px 8px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:var(--white);font-family:'DM Sans',sans-serif;font-size:0.78rem;outline:none;cursor:pointer;}
  .psycho-select option{background:var(--charcoal-2);}

  /* Psychomotor status card */
  .psycho-status-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px;margin-bottom:20px;}
  .psycho-status-card{background:var(--glass);border:1px solid var(--glass-b);border-radius:14px;padding:16px;}
  .psycho-status-card h4{font-size:0.88rem;font-weight:600;margin-bottom:4px;}
  .psycho-status-card p{font-size:0.75rem;color:var(--muted);margin-bottom:10px;}
  .psycho-status-card .status-row{display:flex;align-items:center;justify-content:space-between;}

  /* MODAL */
  .modal{position:fixed;inset:0;z-index:200;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.7);backdrop-filter:blur(6px);padding:20px;}
  .modal.show{display:flex;}
  .modal-card{background:#231d33;border:1px solid rgba(255,255,255,0.12);border-radius:22px;padding:36px;width:100%;max-width:520px;position:relative;animation:popIn 0.3s ease both;max-height:90vh;overflow-y:auto;}
  @keyframes popIn{from{opacity:0;transform:scale(0.92)}to{opacity:1;transform:scale(1)}}
  .modal-close{position:absolute;top:14px;right:18px;background:none;border:none;color:var(--muted);font-size:1.2rem;cursor:pointer;}
  .modal-close:hover{color:var(--white);}
  .modal-title{font-family:'Playfair Display',serif;font-size:1.2rem;margin-bottom:6px;}
  .modal-sub{font-size:0.82rem;color:var(--muted);margin-bottom:22px;}

  .menu-toggle{display:none;position:fixed;top:14px;left:14px;z-index:100;background:var(--amber);border:none;border-radius:10px;padding:7px 11px;cursor:pointer;font-size:1rem;color:#1a1626;}
  .dash-footer{padding:18px 32px;border-top:1px solid rgba(255,255,255,0.06);font-size:0.72rem;color:var(--muted);text-align:center;}

  /* PRINT */
  @media print {
    body{background:white!important;color:#1a1626!important;display:block;}
    .sidebar,.topbar,.menu-toggle,.btn,select,input,.no-print{display:none!important;}
    .main{margin-left:0!important;}
    .content{padding:0!important;}
    .print-header{display:block!important;}
    .section-card-full,.section-card{background:white!important;border:1px solid #ddd!important;color:#1a1626!important;}
    .broadsheet-table th{background:#fff3cd!important;color:#92400e!important;-webkit-print-color-adjust:exact;print-color-adjust:exact;}
    .broadsheet-table td{color:#1a1626!important;border-color:#eee!important;}
    .broadsheet-table tfoot td{background:#fffbeb!important;}
    .g-A{color:#16a34a!important;} .g-P{color:#d97706!important;} .g-F{color:#dc2626!important;}
    .g-A1{color:#16a34a!important;} .g-B2{color:#059669!important;} .g-C4{color:#2563eb!important;}
    .g-D7{color:#d97706!important;} .g-F9{color:#dc2626!important;}
    *{box-shadow:none!important;}
  }

  @media(max-width:1200px){.three-col{grid-template-columns:1fr 1fr}}
  @media(max-width:1000px){.stat-row{grid-template-columns:repeat(2,1fr)}.two-col,.three-col{grid-template-columns:1fr}}
  @media(max-width:768px){.sidebar{transform:translateX(-100%)}.sidebar.open{transform:translateX(0)}.main{margin-left:0}.menu-toggle{display:block}.topbar{padding:12px 16px 12px 56px}.content{padding:18px}.form-grid{grid-template-columns:1fr}}
  @media(max-width:480px){.stat-row{grid-template-columns:1fr 1fr}}
</style>
</head>
<body>

<button class="menu-toggle" onclick="toggleSidebar()">â˜°</button>

<!-- SIDEBAR -->
<aside class="sidebar" id="sidebar">
  <div class="sidebar-logo">
    <div class="s-logo-icon">ğŸ”</div>
    <div class="s-logo-text">Adrem Model Academy<span>Admin Control Room</span></div>
  </div>
  <div class="nav-section">
    <div class="nav-label">Overview</div>
    <button class="nav-item active" onclick="showSection('dashboard',this)"><span class="ni">ğŸ“Š</span> Dashboard</button>
    <button class="nav-item" onclick="showSection('activity',this)"><span class="ni">ğŸ•</span> Activity Log</button>
  </div>
  <div class="nav-section">
    <div class="nav-label">People</div>
    <button class="nav-item" onclick="showSection('students',this)"><span class="ni">ğŸ’</span> Manage Students</button>
    <button class="nav-item" onclick="showSection('staff',this)"><span class="ni">ğŸ‘©â€ğŸ«</span> Manage Staff</button>
    <button class="nav-item" onclick="showSection('classes',this)"><span class="ni">ğŸ«</span> Classes & Arms</button>
  </div>
  <div class="nav-section">
    <div class="nav-label">Academics</div>
    <button class="nav-item" onclick="showSection('scores',this)"><span class="ni">âœï¸</span> Scores & Results</button>
    <button class="nav-item" onclick="showSection('publish',this)"><span class="ni">ğŸ“¤</span> Publish Results</button>
    <button class="nav-item" onclick="showSection('subjects',this)"><span class="ni">ğŸ“š</span> Subjects</button>
    <button class="nav-item" onclick="showSection('broadsheet',this)"><span class="ni">ğŸ“‹</span> Broadsheet</button>
    <button class="nav-item" onclick="showSection('analysis',this)"><span class="ni">ğŸ“ˆ</span> Student Analysis</button>
    <button class="nav-item" onclick="showSection('psychomotor',this)"><span class="ni">ğŸ§ </span> Psychomotor</button>
    <button class="nav-item" onclick="showSection('grading',this)"><span class="ni">ğŸ…</span> Grading System</button>
  </div>
  <div class="nav-section">
    <div class="nav-label">Communication</div>
    <button class="nav-item" onclick="showSection('notices',this)"><span class="ni">ğŸ“¢</span> Notice Board</button>
  </div>
  <div class="nav-section">
    <div class="nav-label">Settings</div>
    <button class="nav-item" onclick="showSection('settings',this)"><span class="ni">âš™ï¸</span> Portal Settings</button>
    <button class="nav-item" onclick="showSection('reset',this)"><span class="ni">ğŸ”‘</span> Reset Passwords</button>
  </div>
  <div class="sidebar-bottom">
    <a href="staff-login.html" class="logout-btn">ğŸšª Log Out</a>
  </div>
</aside>

<!-- MAIN -->
<div class="main">
  <div class="topbar">
    <div class="topbar-left">
      <h2 id="page-title">Admin Control Room</h2>
      <p>2024/2025 Session â€” First Term</p>
    </div>
    <div class="topbar-right">
      <div class="admin-badge">ğŸ” Administrator</div>
      <div class="admin-avatar">AD</div>
    </div>
  </div>

  <div class="content">

    <!-- â•â• DASHBOARD â•â• -->
    <div id="section-dashboard">
      <div class="stat-row">
        <div class="stat-card amber"><div class="sc-icon">ğŸ’</div><div class="sc-val">247</div><div class="sc-lbl">Total Students</div></div>
        <div class="stat-card purple"><div class="sc-icon">ğŸ‘©â€ğŸ«</div><div class="sc-val">18</div><div class="sc-lbl">Total Staff</div></div>
        <div class="stat-card green"><div class="sc-icon">ğŸ«</div><div class="sc-val">12</div><div class="sc-lbl">Active Classes</div></div>
        <div class="stat-card blue"><div class="sc-icon">ğŸ“š</div><div class="sc-val">16</div><div class="sc-lbl">Subjects Offered</div></div>
      </div>
      <div class="stat-row">
        <div class="stat-card green"><div class="sc-icon">âœ…</div><div class="sc-val">68%</div><div class="sc-lbl">Scores Entered</div></div>
        <div class="stat-card amber"><div class="sc-icon">â³</div><div class="sc-val">32%</div><div class="sc-lbl">Scores Pending</div></div>
        <div class="stat-card rose"><div class="sc-icon">ğŸ“Š</div><div class="sc-val">72.4%</div><div class="sc-lbl">School Average</div></div>
        <div class="stat-card red"><div class="sc-icon">ğŸ“¤</div><div class="sc-val">0</div><div class="sc-lbl">Results Published</div></div>
      </div>
      <div class="two-col">
        <div class="section-card">
          <div class="sc-header"><h3>ğŸ« Class Performance Overview</h3><span>Term average</span></div>
          <div class="perf-item"><div class="perf-top"><span>JSS 1A</span><strong>74%</strong></div><div class="perf-track"><div class="perf-fill green" style="width:74%"></div></div></div>
          <div class="perf-item"><div class="perf-top"><span>JSS 1B</span><strong>68%</strong></div><div class="perf-track"><div class="perf-fill amber" style="width:68%"></div></div></div>
          <div class="perf-item"><div class="perf-top"><span>JSS 2A</span><strong>72%</strong></div><div class="perf-track"><div class="perf-fill green" style="width:72%"></div></div></div>
          <div class="perf-item"><div class="perf-top"><span>JSS 2B</span><strong>65%</strong></div><div class="perf-track"><div class="perf-fill amber" style="width:65%"></div></div></div>
          <div class="perf-item"><div class="perf-top"><span>JSS 3A</span><strong>70%</strong></div><div class="perf-track"><div class="perf-fill amber" style="width:70%"></div></div></div>
          <div class="perf-item"><div class="perf-top"><span>SS 1A</span><strong>69%</strong></div><div class="perf-track"><div class="perf-fill purple" style="width:69%"></div></div></div>
          <div class="perf-item"><div class="perf-top"><span>SS 2A</span><strong>66%</strong></div><div class="perf-track"><div class="perf-fill purple" style="width:66%"></div></div></div>
          <div class="perf-item"><div class="perf-top"><span>SS 3A</span><strong>71%</strong></div><div class="perf-track"><div class="perf-fill green" style="width:71%"></div></div></div>
        </div>
        <div class="section-card">
          <div class="sc-header"><h3>ğŸ• Recent Activity</h3><span>Portal-wide</span></div>
          <div class="activity-list">
            <div class="activity-item"><div class="act-icon">âœï¸</div><div class="act-text"><strong>Mrs. Okonkwo entered Maths scores for JSS 2A</strong><span>32 students Â· All submitted</span></div><div class="act-time">2h ago</div></div>
            <div class="activity-item"><div class="act-icon">ğŸ’</div><div class="act-text"><strong>New student registered â€” Taiwo Emmanuel</strong><span>JSS 1A Â· AMA/2025/248</span></div><div class="act-time">5h ago</div></div>
            <div class="activity-item"><div class="act-icon">ğŸ”‘</div><div class="act-text"><strong>Password reset â€” Adeyemi Aisha</strong><span>SMS sent to registered number</span></div><div class="act-time">Yesterday</div></div>
            <div class="activity-item"><div class="act-icon">ğŸ§ </div><div class="act-text"><strong>Psychomotor submitted â€” JSS 2A</strong><span>Mrs. Okonkwo Â· Awaiting Admin approval</span></div><div class="act-time">Yesterday</div></div>
            <div class="activity-item"><div class="act-icon">ğŸ“¢</div><div class="act-text"><strong>Notice sent to all staff</strong><span>Score entry deadline reminder</span></div><div class="act-time">2 days ago</div></div>
          </div>
        </div>
      </div>
      <div class="section-card-full">
        <div class="sc-header"><h3>âœï¸ Score Entry Status â€” All Staff</h3><span>First Term 2024/2025</span></div>
        <div style="overflow-x:auto;">
          <table class="data-table">
            <thead><tr><th>Staff Name</th><th>Subject(s)</th><th>Classes</th><th>CA Entered</th><th>Exam Entered</th><th>Psychomotor</th><th>Status</th><th>Action</th></tr></thead>
            <tbody>
              <tr><td>Mrs. Okonkwo</td><td>Maths, Further Maths</td><td>JSS2A, JSS2B</td><td style="color:var(--green)">âœ…</td><td style="color:var(--green)">âœ…</td><td><span class="badge badge-amber">â³ Awaiting Approval</span></td><td><span class="badge badge-green">Complete</span></td><td><button class="btn btn-sm btn-green" onclick="showToast('Psychomotor approved for JSS 2A!')">Approve</button></td></tr>
              <tr><td>Mr. Adeleke</td><td>English Language</td><td>JSS1A, JSS1B</td><td style="color:var(--green)">âœ…</td><td style="color:var(--amber)">â³</td><td><span class="badge badge-red">âŒ Not Submitted</span></td><td><span class="badge badge-amber">Partial</span></td><td><button class="btn btn-sm btn-amber" onclick="showToast('Reminder sent!')">Remind</button></td></tr>
              <tr><td>Mr. Ibrahim</td><td>Social Studies</td><td>JSS1A, JSS2B</td><td style="color:var(--red)">âŒ</td><td style="color:var(--red)">âŒ</td><td><span class="badge badge-red">âŒ Not Submitted</span></td><td><span class="badge badge-red">Not Started</span></td><td><button class="btn btn-sm btn-red" onclick="showToast('Reminder sent!')">Remind</button></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- â•â• BROADSHEET â€” PLAIN CLEAN VERSION â•â• -->
    <div id="section-broadsheet" style="display:none;">
      <div class="print-header" style="display:none;text-align:center;margin-bottom:20px;padding-bottom:14px;border-bottom:2px solid #d97706;">
        <h2 style="font-family:'Playfair Display',serif;font-size:1.3rem;color:#1a1626;">Adrem Model Academy</h2>
        <p style="color:#6b7280;font-size:0.82rem;">Apomu, Osun State Â· Tel: +234 701 518 2166</p>
        <h3 id="bs-print-title" style="font-family:'Playfair Display',serif;margin-top:10px;color:#d97706;font-size:1rem;">CLASS BROADSHEET â€” FIRST TERM 2024/2025</h3>
      </div>
      <div class="section-card-full">
        <div class="sc-header">
          <h3>ğŸ“‹ Class Broadsheet</h3>
          <div style="display:flex;gap:8px;flex-wrap:wrap;" class="no-print">
            <select id="bs-class" onchange="renderBroadsheet()" style="padding:7px 12px;background:var(--glass);border:1px solid var(--glass-b);border-radius:9px;color:var(--white);font-family:'DM Sans',sans-serif;font-size:0.82rem;outline:none;">
              <option value="JSS">JSS 2A (Junior)</option>
              <option value="SS">SS 2A (Senior)</option>
            </select>
            <button class="btn btn-amber" onclick="printBroadsheet()">ğŸ–¨ï¸ Print Broadsheet</button>
          </div>
        </div>
        <div id="bs-grade-key" class="grade-key"></div>
        <div style="overflow-x:auto;">
          <table class="broadsheet-table" id="broadsheet-table"></table>
        </div>
        <div style="margin-top:12px;font-size:0.75rem;color:var(--muted);">
          Position is calculated based on total score across all subjects. Scores shown as raw totals (CA + Exam).
        </div>
      </div>
    </div>

    <!-- â•â• ANALYSIS â•â• -->
    <div id="section-analysis" style="display:none;">
      <div class="sc-header" style="margin-bottom:16px;">
        <h3>ğŸ“ˆ Student Performance Analysis</h3>
        <select id="an-class" style="padding:7px 12px;background:var(--glass);border:1px solid var(--glass-b);border-radius:9px;color:var(--white);font-family:'DM Sans',sans-serif;font-size:0.82rem;outline:none;">
          <option>JSS 2A</option><option>JSS 1A</option><option>SS 1A</option>
        </select>
      </div>
      <div class="two-col">
        <div class="section-card">
          <div class="sc-header"><h3>ğŸ“Š CA vs Exam Score â€” Per Subject</h3><span>JSS 2A class average</span></div>
          <div style="position:relative;width:100%;">
            <div class="bar-chart" id="ca-exam-chart"></div>
          </div>
          <div class="chart-legend">
            <div class="legend-item"><div class="legend-dot" style="background:var(--purple);"></div>CA Score (avg %)</div>
            <div class="legend-item"><div class="legend-dot" style="background:var(--rose);"></div>Exam Score (avg %)</div>
          </div>
        </div>
        <div class="section-card">
          <div class="sc-header"><h3>ğŸ… Grade Distribution</h3><span>JSS 2A Â· All subjects</span></div>
          <div class="donut-wrap">
            <svg width="120" height="120" viewBox="0 0 120 120">
              <circle cx="60" cy="60" r="45" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="18"/>
              <circle cx="60" cy="60" r="45" fill="none" stroke="#4ade80" stroke-width="18" stroke-dasharray="98.96 184.04" stroke-dashoffset="0" transform="rotate(-90 60 60)"/>
              <circle cx="60" cy="60" r="45" fill="none" stroke="#fbbf24" stroke-width="18" stroke-dasharray="127.23 155.77" stroke-dashoffset="-98.96" transform="rotate(-90 60 60)"/>
              <circle cx="60" cy="60" r="45" fill="none" stroke="#f87171" stroke-width="18" stroke-dasharray="56.55 226.45" stroke-dashoffset="-226.19" transform="rotate(-90 60 60)"/>
              <text x="60" y="56" text-anchor="middle" fill="white" font-size="13" font-family="Playfair Display" font-weight="700">72%</text>
              <text x="60" y="70" text-anchor="middle" fill="#9c8fa3" font-size="8">Avg Score</text>
            </svg>
            <div class="donut-labels">
              <div class="donut-label"><div class="donut-dot" style="background:var(--green);"></div><span>Excellent (A)</span><strong style="color:var(--green);">35%</strong></div>
              <div class="donut-label"><div class="donut-dot" style="background:var(--amber);"></div><span>Pass (P)</span><strong style="color:var(--amber);">45%</strong></div>
              <div class="donut-label"><div class="donut-dot" style="background:var(--red);"></div><span>Fail (F)</span><strong style="color:var(--red);">20%</strong></div>
            </div>
          </div>
          <div style="margin-top:18px;padding-top:14px;border-top:1px solid rgba(255,255,255,0.06);">
            <div class="perf-item"><div class="perf-top"><span>80â€“100</span><strong style="color:var(--green);">8 students</strong></div><div class="perf-track"><div class="perf-fill green" style="width:25%"></div></div></div>
            <div class="perf-item"><div class="perf-top"><span>60â€“79</span><strong style="color:var(--amber);">14 students</strong></div><div class="perf-track"><div class="perf-fill amber" style="width:44%"></div></div></div>
            <div class="perf-item"><div class="perf-top"><span>40â€“59</span><strong style="color:var(--blue);">7 students</strong></div><div class="perf-track"><div class="perf-fill blue" style="width:22%"></div></div></div>
            <div class="perf-item"><div class="perf-top"><span>0â€“39</span><strong style="color:var(--red);">3 students</strong></div><div class="perf-track"><div class="perf-fill red" style="width:9%"></div></div></div>
          </div>
        </div>
      </div>
      <div class="two-col">
        <div class="section-card">
          <div class="sc-header"><h3>ğŸ’ª Subjects Class Excels In</h3><span>Above 65% class average</span></div>
          <div id="strong-subjects"></div>
        </div>
        <div class="section-card">
          <div class="sc-header"><h3>âš ï¸ Subjects Needing Attention</h3><span>Below 60% class average</span></div>
          <div id="weak-subjects"></div>
        </div>
      </div>
      <div class="two-col">
        <div class="section-card">
          <div class="sc-header"><h3>ğŸ† Top 5 Performing Students</h3></div>
          <div id="top-students-analysis"></div>
        </div>
        <div class="section-card">
          <div class="sc-header"><h3>ğŸ¤ Students Needing Support</h3><span>Below 50% overall</span></div>
          <div id="low-students-analysis"></div>
        </div>
      </div>
      <div class="section-card-full">
        <div class="sc-header"><h3>ğŸ“‰ CA vs Exam â€” Per Student</h3><span>Purple = CA Â· Pink = Exam</span></div>
        <div id="student-ca-exam-bars"></div>
      </div>
    </div>

    <!-- â•â• PSYCHOMOTOR â€” ADMIN APPROVAL â•â• -->
    <div id="section-psychomotor" style="display:none;">
      <!-- Submission status per class teacher -->
      <div class="section-card-full">
        <div class="sc-header"><h3>ğŸ§  Psychomotor Submission Status</h3><span>Admin approval required before results are published</span></div>
        <div style="background:rgba(251,191,36,0.08);border:1px solid rgba(251,191,36,0.2);border-radius:12px;padding:14px 16px;margin-bottom:20px;font-size:0.82rem;color:var(--muted);line-height:1.7;">
          ğŸ“‹ <strong style="color:var(--amber-light);">Workflow:</strong> Each Class Teacher fills Psychomotor & Affective grades from their Staff Dashboard. Once submitted, Admin reviews and approves below. Approved grades are automatically included in the student's printed result sheet.
        </div>
        <div class="psycho-status-grid">
          <div class="psycho-status-card" style="border-color:var(--amber-b);background:var(--amber-bg);">
            <h4>JSS 2A</h4>
            <p>Class Teacher: Mrs. Okonkwo</p>
            <div class="status-row">
              <span class="badge badge-amber">â³ Submitted â€” Pending Approval</span>
              <button class="btn btn-sm btn-green" onclick="approvePsycho('JSS 2A')">âœ… Approve</button>
            </div>
          </div>
          <div class="psycho-status-card" style="border-color:var(--red-b);background:var(--red-bg);">
            <h4>JSS 1A</h4>
            <p>Class Teacher: Mr. Adeleke</p>
            <div class="status-row">
              <span class="badge badge-red">âŒ Not Yet Submitted</span>
              <button class="btn btn-sm btn-amber" onclick="showToast('Reminder sent to Mr. Adeleke')">Remind</button>
            </div>
          </div>
          <div class="psycho-status-card" style="border-color:var(--red-b);background:var(--red-bg);">
            <h4>JSS 1B</h4>
            <p>Class Teacher: Mrs. Afolabi</p>
            <div class="status-row">
              <span class="badge badge-red">âŒ Not Yet Submitted</span>
              <button class="btn btn-sm btn-amber" onclick="showToast('Reminder sent to Mrs. Afolabi')">Remind</button>
            </div>
          </div>
          <div class="psycho-status-card" style="border-color:var(--green-b);background:var(--green-bg);">
            <h4>SS 1A</h4>
            <p>Class Teacher: Mrs. Fashola</p>
            <div class="status-row">
              <span class="badge badge-green">âœ… Approved</span>
              <button class="btn btn-sm btn-purple" onclick="showToast('Viewing SS 1A psychomotor...')">View</button>
            </div>
          </div>
        </div>
      </div>

      <!-- View submitted psychomotor for approved/pending classes -->
      <div class="section-card-full">
        <div class="sc-header">
          <h3>ğŸ“‹ View Submitted Psychomotor â€” JSS 2A</h3>
          <div style="display:flex;gap:8px;">
            <span class="badge badge-amber">â³ Awaiting Approval</span>
            <button class="btn btn-sm btn-green" onclick="approvePsycho('JSS 2A')">âœ… Approve All</button>
          </div>
        </div>
        <div style="background:rgba(251,191,36,0.07);border:1px solid rgba(251,191,36,0.2);border-radius:10px;padding:12px 14px;margin-bottom:16px;font-size:0.8rem;color:var(--muted);">
          Submitted by <strong style="color:var(--white);">Mrs. Funke Okonkwo</strong> Â· Class Teacher, JSS 2A Â· Yesterday at 3:42 PM
        </div>
        <div style="font-size:0.75rem;margin-bottom:12px;display:flex;gap:14px;flex-wrap:wrap;">
          <span style="color:var(--green);">5 = Excellent</span><span style="color:var(--blue);">4 = Very Good</span>
          <span style="color:var(--amber);">3 = Good</span><span style="color:var(--rose-light);">2 = Fair</span><span style="color:var(--red);">1 = Poor</span>
        </div>
        <div style="overflow-x:auto;">
          <table class="psycho-table">
            <thead>
              <tr>
                <th style="min-width:140px;">Student Name</th>
                <th>Punctuality</th><th>Attentiveness</th><th>Neatness</th>
                <th>Politeness</th><th>Honesty</th><th>Sports</th>
                <th>Clubs</th><th>Creativity</th><th>Leadership</th><th>Conduct</th>
              </tr>
            </thead>
            <tbody id="admin-psycho-view"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- â•â• GRADING SYSTEM â•â• -->
    <div id="section-grading" style="display:none;">
      <div class="two-col">
        <div class="section-card">
          <div class="sc-header"><h3>ğŸ« Junior School Grading (JSS 1â€“3)</h3></div>
          <div style="background:var(--amber-bg);border:1px solid var(--amber-b);border-radius:10px;padding:12px;margin-bottom:16px;font-size:0.78rem;color:var(--muted);line-height:1.7;">
            Simple, clear grading designed for junior secondary students.
          </div>
          <table class="data-table">
            <thead><tr><th>Score Range</th><th>Grade</th><th>Remark</th><th>Description</th></tr></thead>
            <tbody>
              <tr><td style="color:var(--green);font-weight:700;">70 â€“ 100</td><td><span class="badge badge-green" style="font-size:0.85rem;padding:4px 14px;">A</span></td><td style="color:var(--green);">Excellent</td><td style="color:var(--muted);font-size:0.78rem;">Student has mastered subject content</td></tr>
              <tr><td style="color:var(--amber);font-weight:700;">40 â€“ 69</td><td><span class="badge badge-amber" style="font-size:0.85rem;padding:4px 14px;">P</span></td><td style="color:var(--amber);">Pass</td><td style="color:var(--muted);font-size:0.78rem;">Student meets minimum requirement</td></tr>
              <tr><td style="color:var(--red);font-weight:700;">0 â€“ 39</td><td><span class="badge badge-red" style="font-size:0.85rem;padding:4px 14px;">F</span></td><td style="color:var(--red);">Fail</td><td style="color:var(--muted);font-size:0.78rem;">Student needs significant improvement</td></tr>
            </tbody>
          </table>
          <div style="margin-top:14px;padding:12px;background:var(--glass);border:1px solid var(--glass-b);border-radius:10px;font-size:0.78rem;color:var(--muted);line-height:1.7;">
            ğŸ“Œ CA = 30 marks Â· Exam = 70 marks Â· Total = 100 marks
          </div>
        </div>
        <div class="section-card">
          <div class="sc-header"><h3>ğŸ“ Senior School â€” WAEC Standard (SS 1â€“3)</h3></div>
          <div style="background:var(--purple-bg);border:1px solid var(--purple-b);border-radius:10px;padding:12px;margin-bottom:16px;font-size:0.78rem;color:var(--muted);line-height:1.7;">
            Official WAEC grading adopted for all senior secondary students.
          </div>
          <table class="data-table">
            <thead><tr><th>Score Range</th><th>Grade</th><th>Remark</th></tr></thead>
            <tbody>
              <tr><td style="color:var(--green);font-weight:700;">75 â€“ 100</td><td><span class="g-A1">A1</span></td><td style="color:var(--green);">Excellent</td></tr>
              <tr><td style="color:#34d399;font-weight:700;">70 â€“ 74</td><td><span class="g-B2">B2</span></td><td style="color:#34d399;">Very Good</td></tr>
              <tr><td style="color:#6ee7b7;font-weight:700;">65 â€“ 69</td><td><span class="g-B3">B3</span></td><td style="color:#6ee7b7;">Good</td></tr>
              <tr><td style="color:var(--blue);font-weight:700;">60 â€“ 64</td><td><span class="g-C4">C4</span></td><td style="color:var(--blue);">Credit</td></tr>
              <tr><td style="color:#93c5fd;font-weight:700;">55 â€“ 59</td><td><span class="g-C5">C5</span></td><td style="color:#93c5fd;">Credit</td></tr>
              <tr><td style="color:var(--amber);font-weight:700;">50 â€“ 54</td><td><span class="g-C6">C6</span></td><td style="color:var(--amber);">Credit</td></tr>
              <tr><td style="color:var(--amber-light);font-weight:700;">45 â€“ 49</td><td><span class="g-D7">D7</span></td><td style="color:var(--amber-light);">Pass</td></tr>
              <tr><td style="color:var(--rose-light);font-weight:700;">40 â€“ 44</td><td><span class="g-E8">E8</span></td><td style="color:var(--rose-light);">Pass</td></tr>
              <tr><td style="color:var(--red);font-weight:700;">0 â€“ 39</td><td><span class="g-F9">F9</span></td><td style="color:var(--red);">Fail</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- â•â• MANAGE STUDENTS â•â• -->
    <div id="section-students" style="display:none;">
      <div class="section-card-full">
        <div class="sc-header"><h3>ğŸ’ Manage Students</h3><button class="btn btn-amber" onclick="openModal('add-student')">+ Add New Student</button></div>
        <div style="display:flex;gap:10px;margin-bottom:16px;flex-wrap:wrap;">
          <input type="text" placeholder="ğŸ” Search by name or reg number..." style="flex:1;min-width:200px;padding:9px 14px;background:var(--glass);border:1px solid var(--glass-b);border-radius:10px;color:var(--white);font-family:'DM Sans',sans-serif;font-size:0.85rem;outline:none;">
          <select style="padding:9px 14px;background:var(--glass);border:1px solid var(--glass-b);border-radius:10px;color:var(--white);font-family:'DM Sans',sans-serif;font-size:0.82rem;outline:none;"><option>All Classes</option><option>JSS 1A</option><option>JSS 2A</option><option>SS 1A</option></select>
        </div>
        <div style="overflow-x:auto;"><table class="data-table"><thead><tr><th>Reg Number</th><th>Student Name</th><th>Class</th><th>Class Teacher</th><th>Status</th><th>Actions</th></tr></thead><tbody id="student-table-body"></tbody></table></div>
      </div>
    </div>

    <!-- â•â• MANAGE STAFF â•â• -->
    <div id="section-staff" style="display:none;">
      <div class="section-card-full">
        <div class="sc-header"><h3>ğŸ‘©â€ğŸ« Manage Staff</h3><button class="btn btn-purple" onclick="openModal('add-staff')">+ Add New Staff</button></div>
        <div style="overflow-x:auto;"><table class="data-table"><thead><tr><th>Staff Name</th><th>Phone</th><th>Subject(s)</th><th>Class Teacher</th><th>Status</th><th>Actions</th></tr></thead><tbody id="staff-table-body"></tbody></table></div>
      </div>
    </div>

    <!-- â•â• CLASSES â•â• -->
    <div id="section-classes" style="display:none;">
      <div class="sc-header" style="margin-bottom:16px;"><h3>ğŸ« Classes & Arms</h3><button class="btn btn-amber" onclick="openModal('add-class')">+ Add Class</button></div>
      <div class="class-grid" id="class-grid"></div>
    </div>

    <!-- â•â• SCORES â•â• -->
    <div id="section-scores" style="display:none;">
      <div class="section-card-full">
        <div class="sc-header">
          <h3>âœï¸ View & Edit Scores</h3>
          <div style="display:flex;gap:8px;flex-wrap:wrap;">
            <select style="padding:7px 12px;background:var(--glass);border:1px solid var(--glass-b);border-radius:9px;color:var(--white);font-family:'DM Sans',sans-serif;font-size:0.82rem;outline:none;"><option>JSS 2A</option><option>JSS 1A</option></select>
            <select style="padding:7px 12px;background:var(--glass);border:1px solid var(--glass-b);border-radius:9px;color:var(--white);font-family:'DM Sans',sans-serif;font-size:0.82rem;outline:none;"><option>Mathematics</option><option>English</option></select>
            <button class="btn btn-amber" onclick="showToast('Scores loaded!')">Load</button>
          </div>
        </div>
        <div style="overflow-x:auto;"><table class="data-table"><thead><tr><th>Student</th><th>Reg No</th><th>CA (30)</th><th>Exam (70)</th><th>Total</th><th>Grade</th><th>Save</th></tr></thead><tbody id="admin-score-body"></tbody></table></div>
        <div style="margin-top:14px;display:flex;gap:10px;">
          <button class="btn btn-green" onclick="showToast('All scores saved!')">ğŸ’¾ Save All</button>
          <button class="btn btn-amber" onclick="showToast('Exported!')">ğŸ“¥ Export PDF</button>
        </div>
      </div>
    </div>

    <!-- â•â• PUBLISH â•â• -->
    <div id="section-publish" style="display:none;">
      <div class="section-card-full">
        <div class="sc-header"><h3>ğŸ“¤ Publish Results</h3><span>Make results visible to students</span></div>
        <div style="background:rgba(251,191,36,0.08);border:1px solid rgba(251,191,36,0.2);border-radius:12px;padding:14px;margin-bottom:16px;font-size:0.82rem;color:var(--muted);">âš ï¸ Once published, students can view results on their dashboards immediately. Ensure all scores AND psychomotor grades are approved before publishing.</div>
        <div style="overflow-x:auto;"><table class="data-table"><thead><tr><th>Class</th><th>Students</th><th>Scores</th><th>Psychomotor</th><th>Status</th><th>Action</th></tr></thead><tbody>
          <tr><td>JSS 1A</td><td>28</td><td style="color:var(--green)">âœ… Complete</td><td><span class="badge badge-red">âŒ Not Approved</span></td><td><span class="badge badge-red">Not Ready</span></td><td><button class="btn btn-sm" style="background:var(--glass);color:var(--muted);border:1px solid var(--glass-b);" disabled>Waiting</button></td></tr>
          <tr><td>JSS 2A</td><td>32</td><td style="color:var(--green)">âœ… Complete</td><td><span class="badge badge-amber">â³ Pending Approval</span></td><td><span class="badge badge-amber">Almost Ready</span></td><td><button class="btn btn-sm btn-amber" onclick="showToast('Approve psychomotor first!')">Approve Psycho First</button></td></tr>
          <tr><td>SS 1A</td><td>22</td><td style="color:var(--green)">âœ… Complete</td><td><span class="badge badge-green">âœ… Approved</span></td><td><span class="badge badge-green">Ready</span></td><td><button class="btn btn-sm btn-green" onclick="showToast('SS 1A results published!')">Publish Now</button></td></tr>
        </tbody></table></div>
      </div>
    </div>

    <!-- â•â• SUBJECTS â•â• -->
    <div id="section-subjects" style="display:none;">
      <div class="section-card-full">
        <div class="sc-header"><h3>ğŸ“š Subjects Offered</h3><button class="btn btn-amber" onclick="openModal('add-subject')">+ Add Subject</button></div>
        <div style="overflow-x:auto;"><table class="data-table"><thead><tr><th>Subject</th><th>Level</th><th>Teacher</th><th>Classes</th><th>Actions</th></tr></thead><tbody>
          <tr><td>Mathematics</td><td><span class="badge badge-blue">JSS</span></td><td>Mrs. Okonkwo</td><td>JSS1Aâ€“JSS3A</td><td class="actions"><button class="btn btn-sm btn-amber" onclick="showToast('Edit')">Edit</button><button class="btn btn-sm btn-red" onclick="showToast('Removed')">Remove</button></td></tr>
          <tr><td>English Language</td><td><span class="badge badge-blue">JSS</span></td><td>Mr. Adeleke</td><td>JSS1Aâ€“JSS3A</td><td class="actions"><button class="btn btn-sm btn-amber" onclick="showToast('Edit')">Edit</button><button class="btn btn-sm btn-red" onclick="showToast('Removed')">Remove</button></td></tr>
          <tr><td>Further Mathematics</td><td><span class="badge badge-purple">SS</span></td><td>Mrs. Okonkwo</td><td>SS2A, SS2B</td><td class="actions"><button class="btn btn-sm btn-amber" onclick="showToast('Edit')">Edit</button><button class="btn btn-sm btn-red" onclick="showToast('Removed')">Remove</button></td></tr>
        </tbody></table></div>
      </div>
    </div>

    <!-- â•â• NOTICES â•â• -->
    <div id="section-notices" style="display:none;">
      <div class="two-col">
        <div class="section-card">
          <div class="sc-header"><h3>ğŸ“¢ Compose Notice</h3></div>
          <div class="field"><label>Title</label><input type="text" placeholder="Notice title"></div>
          <div class="field"><label>Send To</label><select><option>All Staff</option><option>All Students</option><option>Class Teachers Only</option><option>Everyone</option></select></div>
          <div class="field"><label>Priority</label><select><option>Normal</option><option>Urgent</option><option>Information</option></select></div>
          <div class="field"><label>Message</label><textarea placeholder="Type your notice..."></textarea></div>
          <button class="btn btn-amber" style="width:100%;" onclick="showToast('Notice sent!')">ğŸ“¢ Send Notice</button>
        </div>
        <div class="section-card">
          <div class="sc-header"><h3>ğŸ“‹ Sent Notices</h3></div>
          <div class="notice-list">
            <div class="notice-item"><div class="notice-dot urgent"></div><div class="notice-text"><strong>Score Entry Deadline â€” Friday</strong><span>All Staff Â· 2 days ago</span></div></div>
            <div class="notice-item"><div class="notice-dot normal"></div><div class="notice-text"><strong>Staff Meeting â€” Monday</strong><span>All Staff Â· 3 days ago</span></div></div>
            <div class="notice-item"><div class="notice-dot info"></div><div class="notice-text"><strong>Report Cards Ready</strong><span>Class Teachers Â· 5 days ago</span></div></div>
          </div>
        </div>
      </div>
    </div>

    <!-- â•â• RESET â•â• -->
    <div id="section-reset" style="display:none;">
      <div class="two-col">
        <div class="section-card">
          <div class="sc-header"><h3>ğŸ”‘ Reset Student Password</h3></div>
          <div class="field"><label>Search Student</label><input type="text" placeholder="Name or reg number..."></div>
          <div style="background:var(--glass);border:1px solid var(--glass-b);border-radius:12px;padding:14px;margin-bottom:14px;"><div style="font-size:0.82rem;font-weight:600;">Adeyemi Aisha Folake</div><div style="font-size:0.75rem;color:var(--muted);">AMA/2025/042 Â· JSS 2A Â· Phone: 08055566677</div></div>
          <div class="field"><label>New Password</label><input type="text" value="Adeyemi"></div>
          <button class="btn btn-rose" style="width:100%;" onclick="showToast('Password reset! SMS sent.')">ğŸ”‘ Reset & Notify via SMS</button>
        </div>
        <div class="section-card">
          <div class="sc-header"><h3>ğŸ”‘ Reset Staff Password</h3></div>
          <div class="field"><label>Search Staff</label><input type="text" placeholder="Name or phone..."></div>
          <div style="background:var(--glass);border:1px solid var(--glass-b);border-radius:12px;padding:14px;margin-bottom:14px;"><div style="font-size:0.82rem;font-weight:600;">Mrs. Funke Okonkwo</div><div style="font-size:0.75rem;color:var(--muted);">08012345678 Â· Mathematics Â· JSS 2A</div></div>
          <div class="field"><label>New Password</label><input type="text" value="Okonkwo"></div>
          <button class="btn btn-purple" style="width:100%;" onclick="showToast('Password reset! SMS sent.')">ğŸ”‘ Reset & Notify via SMS</button>
        </div>
      </div>
      <div class="section-card-full">
        <div class="sc-header"><h3>ğŸ« Assign / Change Class Teacher</h3><span>Reflects immediately on student & staff dashboards</span></div>
        <div class="form-grid">
          <div class="field"><label>Select Class</label><select><option>JSS 1A</option><option>JSS 2A</option><option>SS 1A</option></select></div>
          <div class="field"><label>Assign Class Teacher</label><select><option>Mrs. Funke Okonkwo</option><option>Mr. Tunde Adeleke</option><option>Mrs. Bimpe Fashola</option></select></div>
        </div>
        <button class="btn btn-amber" onclick="showToast('Class teacher assigned! Dashboards updated.')">âœ… Assign Class Teacher</button>
      </div>
    </div>

    <!-- â•â• SETTINGS â•â• -->
    <div id="section-settings" style="display:none;">
      <div class="two-col">
        <div class="section-card">
          <div class="sc-header"><h3>âš™ï¸ Session & Term</h3></div>
          <div class="field"><label>Academic Session</label><input type="text" value="2024/2025"></div>
          <div class="field"><label>Current Term</label><select><option>First Term</option><option>Second Term</option><option>Third Term</option></select></div>
          <div class="field"><label>Term Start Date</label><input type="date" value="2025-01-06"></div>
          <div class="field"><label>Term End Date</label><input type="date" value="2025-03-28"></div>
          <button class="btn btn-amber" style="width:100%;" onclick="showToast('Settings saved!')">ğŸ’¾ Save Settings</button>
        </div>
        <div class="section-card">
          <div class="sc-header"><h3>ğŸ« School Information</h3></div>
          <div class="field"><label>School Name</label><input type="text" value="Adrem Model Academy"></div>
          <div class="field"><label>Address</label><input type="text" value="Apomu, Osun State, Nigeria"></div>
          <div class="field"><label>Phone 1</label><input type="text" value="+234 701 518 2166"></div>
          <div class="field"><label>Email</label><input type="text" value="adremodelacademy@yahoo.com"></div>
          <button class="btn btn-amber" style="width:100%;" onclick="showToast('Info saved!')">ğŸ’¾ Save Info</button>
        </div>
      </div>
      <div class="section-card-full">
        <div class="sc-header"><h3>ğŸ” Change Admin Password</h3></div>
        <div class="form-grid">
          <div class="field"><label>Current Password</label><input type="password" placeholder="Current password"></div>
          <div class="field"><label>New Password</label><input type="password" placeholder="New password"></div>
          <div class="field"><label>Confirm Password</label><input type="password" placeholder="Repeat new password"></div>
          <div class="field"><label>Admin Email</label><input type="email" value="admin@adremacademy.edu.ng"></div>
        </div>
        <button class="btn btn-amber" onclick="showToast('Password updated!')">ğŸ” Update Password</button>
      </div>
    </div>

    <!-- â•â• ACTIVITY â•â• -->
    <div id="section-activity" style="display:none;">
      <div class="section-card-full">
        <div class="sc-header"><h3>ğŸ• Full Activity Log</h3></div>
        <div class="activity-list" id="full-activity"></div>
      </div>
    </div>

  </div>
  <div class="dash-footer">Â© 2026 Adrem Model Academy Admin Portal â€” Apomu, Osun State</div>
</div>

<!-- MODALS -->
<div class="modal" id="modal-add-student">
  <div class="modal-card">
    <button class="modal-close" onclick="closeModal('add-student')">âœ•</button>
    <div class="modal-title">ğŸ’ Add New Student</div>
    <div class="modal-sub">Reg number auto-generated. Default password = Surname.</div>
    <div class="form-grid">
      <div class="field"><label>First Name</label><input type="text" placeholder="e.g. Aisha"></div>
      <div class="field"><label>Surname</label><input type="text" placeholder="e.g. Adeyemi"></div>
      <div class="field"><label>Date of Birth</label><input type="date"></div>
      <div class="field"><label>Gender</label><select><option>Female</option><option>Male</option></select></div>
      <div class="field"><label>Class</label><select><option>JSS 1A</option><option>JSS 2A</option><option>SS 1A</option></select></div>
      <div class="field"><label>Parent Phone (for SMS resets)</label><input type="text" placeholder="08012345678"></div>
    </div>
    <div style="display:flex;gap:10px;margin-top:14px;">
      <button class="btn btn-amber" style="flex:1;" onclick="showToast('Student added!');closeModal('add-student')">âœ… Add Student</button>
      <button class="btn" style="background:var(--glass);border:1px solid var(--glass-b);color:var(--muted);" onclick="closeModal('add-student')">Cancel</button>
    </div>
  </div>
</div>

<div class="modal" id="modal-add-staff">
  <div class="modal-card">
    <button class="modal-close" onclick="closeModal('add-staff')">âœ•</button>
    <div class="modal-title">ğŸ‘©â€ğŸ« Add New Staff</div>
    <div class="modal-sub">Staff login with phone number. Default password = Surname.</div>
    <div class="form-grid">
      <div class="field"><label>Full Name</label><input type="text" placeholder="Mrs. Funke Okonkwo"></div>
      <div class="field"><label>Surname</label><input type="text" placeholder="Okonkwo"></div>
      <div class="field"><label>Phone Number</label><input type="text" placeholder="08012345678"></div>
      <div class="field"><label>Qualification</label><input type="text" placeholder="B.Ed Mathematics"></div>
      <div class="field"><label>Subject(s)</label><input type="text" placeholder="Mathematics, Further Maths"></div>
      <div class="field"><label>Is Class Teacher?</label><select><option>No</option><option>Yes</option></select></div>
      <div class="field"><label>Assign Class (if Class Teacher)</label><select><option>â€” Not Applicable â€”</option><option>JSS 1A</option><option>JSS 2A</option></select></div>
    </div>
    <div style="display:flex;gap:10px;margin-top:14px;">
      <button class="btn btn-purple" style="flex:1;" onclick="showToast('Staff added!');closeModal('add-staff')">âœ… Add Staff</button>
      <button class="btn" style="background:var(--glass);border:1px solid var(--glass-b);color:var(--muted);" onclick="closeModal('add-staff')">Cancel</button>
    </div>
  </div>
</div>

<div class="modal" id="modal-add-class">
  <div class="modal-card">
    <button class="modal-close" onclick="closeModal('add-class')">âœ•</button>
    <div class="modal-title">ğŸ« Add New Class</div>
    <div class="field"><label>Class Name</label><input type="text" placeholder="e.g. JSS 3B"></div>
    <div class="field"><label>Level</label><select><option>JSS</option><option>SS</option><option>Primary</option></select></div>
    <div class="field"><label>Assign Class Teacher</label><select><option>â€” Assign Later â€”</option><option>Mrs. Okonkwo</option><option>Mr. Adeleke</option></select></div>
    <div style="display:flex;gap:10px;margin-top:14px;">
      <button class="btn btn-amber" style="flex:1;" onclick="showToast('Class added!');closeModal('add-class')">âœ… Add Class</button>
      <button class="btn" style="background:var(--glass);border:1px solid var(--glass-b);color:var(--muted);" onclick="closeModal('add-class')">Cancel</button>
    </div>
  </div>
</div>

<div class="modal" id="modal-add-subject">
  <div class="modal-card">
    <button class="modal-close" onclick="closeModal('add-subject')">âœ•</button>
    <div class="modal-title">ğŸ“š Add New Subject</div>
    <div class="field"><label>Subject Name</label><input type="text" placeholder="e.g. Agricultural Science"></div>
    <div class="field"><label>Level</label><select><option>JSS</option><option>SS</option><option>Both</option></select></div>
    <div class="field"><label>Assigned Teacher</label><select><option>Mrs. Okonkwo</option><option>Mr. Adeleke</option></select></div>
    <div class="field"><label>Classes</label><input type="text" placeholder="e.g. JSS1A, JSS1B"></div>
    <div style="display:flex;gap:10px;margin-top:14px;">
      <button class="btn btn-amber" style="flex:1;" onclick="showToast('Subject added!');closeModal('add-subject')">âœ… Add Subject</button>
      <button class="btn" style="background:var(--glass);border:1px solid var(--glass-b);color:var(--muted);" onclick="closeModal('add-subject')">Cancel</button>
    </div>
  </div>
</div>

<div id="toast" style="position:fixed;bottom:28px;right:28px;background:#231d33;border:1px solid rgba(251,191,36,0.3);border-radius:12px;padding:12px 18px;font-size:0.83rem;color:var(--white);z-index:500;opacity:0;transform:translateY(10px);transition:all 0.3s;pointer-events:none;max-width:300px;"></div>

<script>
// â”€â”€ Data â”€â”€
const subjects=['Mathematics','English','Basic Science','Social Studies','Yoruba','Business Stud.','Agric Science','French','PHE','Computer Stud.'];
const subjectAvgCA=[87,80,73,60,63,57,46,43,40,85];
const subjectAvgExam=[88,82,77,66,65,62,52,49,46,85];

const studentsData=[
  {reg:'AMA/2025/042',name:'Adeyemi Aisha',    cls:'JSS 2A',teacher:'Mrs. Okonkwo',ca:[26,24,22,18,19,17,14,13,12,25],exam:[62,58,55,48,46,45,38,36,34,60]},
  {reg:'AMA/2025/015',name:'Babatunde Olamide',cls:'JSS 2A',teacher:'Mrs. Okonkwo',ca:[25,23,21,20,18,19,16,15,14,24],exam:[60,56,52,48,44,43,40,38,35,58]},
  {reg:'AMA/2025/007',name:'Chukwu Faith',     cls:'JSS 2A',teacher:'Mrs. Okonkwo',ca:[24,22,20,18,17,16,15,13,11,23],exam:[57,55,50,45,43,41,38,35,32,56]},
  {reg:'AMA/2025/033',name:'Dada Nifemi',      cls:'JSS 2A',teacher:'Mrs. Okonkwo',ca:[20,19,18,16,15,14,12,11,10,20],exam:[52,50,47,43,40,39,35,33,30,52]},
  {reg:'AMA/2025/021',name:'Eze Kingsley',     cls:'JSS 2A',teacher:'Mrs. Okonkwo',ca:[19,18,17,15,14,13,11,10,9,19], exam:[50,48,45,41,38,37,33,31,28,50]},
  {reg:'AMA/2025/011',name:'Fadeyi Adeola',    cls:'JSS 2A',teacher:'Mrs. Okonkwo',ca:[18,17,15,14,13,12,10,9,8,17],  exam:[47,45,42,38,36,34,30,28,25,47]},
  {reg:'AMA/2025/028',name:'Gbadebo Oluwaseun',cls:'JSS 2A',teacher:'Mrs. Okonkwo',ca:[17,15,14,13,11,11,9,8,7,16],   exam:[44,42,39,35,33,31,28,25,22,44]},
  {reg:'AMA/2025/039',name:'Hassan Maryam',    cls:'JSS 2A',teacher:'Mrs. Okonkwo',ca:[15,14,12,11,10,9,8,7,6,14],    exam:[43,40,36,32,30,28,25,22,20,42]},
  {reg:'AMA/2025/044',name:'Ikenna Joy',       cls:'JSS 2A',teacher:'Mrs. Okonkwo',ca:[14,12,11,10,9,8,7,6,5,13],     exam:[40,37,34,30,28,26,22,20,18,40]},
  {reg:'AMA/2025/006',name:'Johnson Akintola', cls:'JSS 2A',teacher:'Mrs. Okonkwo',ca:[13,11,10,9,8,7,6,5,4,12],      exam:[38,34,31,27,25,23,20,18,15,37]},
];

function jssGrade(t){return t>=70?'A':t>=40?'P':'F';}
function jssGradeClass(t){return t>=70?'g-A':t>=40?'g-P':'g-F';}
function waecGrade(t){return t>=75?'A1':t>=70?'B2':t>=65?'B3':t>=60?'C4':t>=55?'C5':t>=50?'C6':t>=45?'D7':t>=40?'E8':'F9';}
function waecGradeClass(t){return t>=75?'g-A1':t>=70?'g-B2':t>=65?'g-B3':t>=60?'g-C4':t>=55?'g-C5':t>=50?'g-C6':t>=45?'g-D7':t>=40?'g-E8':'g-F9';}

// â”€â”€ Nav â”€â”€
function toggleSidebar(){document.getElementById('sidebar').classList.toggle('open');}
const allSections=['dashboard','activity','students','staff','classes','scores','publish','subjects','broadsheet','analysis','psychomotor','grading','notices','reset','settings'];
const titles={dashboard:'Admin Control Room',activity:'Activity Log',students:'Manage Students',staff:'Manage Staff',classes:'Classes & Arms',scores:'Scores & Results',publish:'Publish Results',subjects:'Subjects',broadsheet:'Class Broadsheet',analysis:'Student Performance Analysis',psychomotor:'Psychomotor & Affective Assessment',grading:'Grading System',notices:'Notice Board',reset:'Reset Passwords',settings:'Portal Settings'};

function showSection(name,el){
  allSections.forEach(s=>{const e=document.getElementById('section-'+s);if(e)e.style.display=s===name?'block':'none';});
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  if(el)el.classList.add('active');
  document.getElementById('page-title').textContent=titles[name]||name;
  if(name==='broadsheet')renderBroadsheet();
  if(name==='analysis')renderAnalysis();
  if(name==='psychomotor')renderAdminPsycho();
  if(name==='students')renderStudentTable();
  if(name==='staff')renderStaffTable();
  if(name==='classes')renderClassGrid();
  if(name==='scores')renderAdminScores();
  if(name==='activity')renderActivity();
}

// â”€â”€ BROADSHEET â€” Plain, no medals, no dots â”€â”€
function renderBroadsheet(){
  const isJSS=document.getElementById('bs-class').value==='JSS';
  const gFn=isJSS?jssGrade:waecGrade;
  const gcFn=isJSS?jssGradeClass:waecGradeClass;

  const keyEl=document.getElementById('bs-grade-key');
  keyEl.innerHTML=isJSS
    ?`<div class="gk-item"><span class="g-A">A</span><span style="color:var(--muted)">= Excellent (70â€“100)</span></div>
      <div class="gk-item"><span class="g-P">P</span><span style="color:var(--muted)">= Pass (40â€“69)</span></div>
      <div class="gk-item"><span class="g-F">F</span><span style="color:var(--muted)">= Fail (0â€“39)</span></div>`
    :`<div class="gk-item"><span class="g-A1">A1</span><span style="color:var(--muted)">75â€“100</span></div>
      <div class="gk-item"><span class="g-B2">B2</span><span style="color:var(--muted)">70â€“74</span></div>
      <div class="gk-item"><span class="g-B3">B3</span><span style="color:var(--muted)">65â€“69</span></div>
      <div class="gk-item"><span class="g-C4">C4</span><span style="color:var(--muted)">60â€“64</span></div>
      <div class="gk-item"><span class="g-C5">C5</span><span style="color:var(--muted)">55â€“59</span></div>
      <div class="gk-item"><span class="g-C6">C6</span><span style="color:var(--muted)">50â€“54</span></div>
      <div class="gk-item"><span class="g-D7">D7</span><span style="color:var(--muted)">45â€“49</span></div>
      <div class="gk-item"><span class="g-E8">E8</span><span style="color:var(--muted)">40â€“44</span></div>
      <div class="gk-item"><span class="g-F9">F9</span><span style="color:var(--muted)">0â€“39</span></div>`;

  const rows=studentsData.map(s=>{
    const totals=s.ca.map((c,i)=>c+s.exam[i]);
    const grandTotal=totals.reduce((a,b)=>a+b,0);
    const avg=(grandTotal/subjects.length).toFixed(1);
    return{...s,totals,grandTotal,avg};
  }).sort((a,b)=>b.grandTotal-a.grandTotal).map((s,i)=>({...s,position:i+1}));

  const subjectTotals=subjects.map((_,si)=>{
    const sum=studentsData.reduce((acc,s)=>acc+(s.ca[si]+s.exam[si]),0);
    return(sum/studentsData.length).toFixed(0);
  });

  // PLAIN table â€” no medals, no dots
  let html=`<thead><tr>
    <th class="name-col" style="text-align:center;width:40px;">Pos.</th>
    <th class="name-col">Student Name</th>
    <th>Reg No</th>
    ${subjects.map(s=>`<th>${s.substring(0,9)}<br><small style="font-size:0.6rem;opacity:0.7;">/100</small></th>`).join('')}
    <th>Total</th><th>Avg%</th><th>Grade</th>
  </tr></thead><tbody>`;

  rows.forEach(s=>{
    html+=`<tr>
      <td class="pos-col" style="text-align:center;">${s.position}</td>
      <td class="name-col">${s.name}</td>
      <td style="color:var(--muted);font-size:0.72rem;white-space:nowrap;">${s.reg}</td>
      ${s.totals.map((t,si)=>`<td>
        <span class="${gcFn(t)}">${gFn(t)}</span>
        <br><small style="color:var(--muted);font-size:0.65rem;">${t}</small>
      </td>`).join('')}
      <td style="font-weight:700;color:var(--amber-light);">${s.grandTotal}</td>
      <td style="color:var(--muted);">${s.avg}%</td>
      <td><span class="${gcFn(parseFloat(s.avg))}">${gFn(parseFloat(s.avg))}</span></td>
    </tr>`;
  });

  const grandAvg=(studentsData.reduce((a,s)=>a+s.ca.reduce((x,c,i)=>x+c+s.exam[i],0),0)/studentsData.length).toFixed(0);
  html+=`</tbody><tfoot><tr>
    <td colspan="3" style="text-align:left;">CLASS AVERAGE</td>
    ${subjectTotals.map(a=>`<td>${a}</td>`).join('')}
    <td>${grandAvg}</td>
    <td>${(parseFloat(grandAvg)/subjects.length*10).toFixed(1)}%</td>
    <td></td>
  </tr></tfoot>`;

  document.getElementById('broadsheet-table').innerHTML=html;
  document.getElementById('bs-print-title').textContent=`CLASS BROADSHEET â€” ${document.getElementById('bs-class').options[document.getElementById('bs-class').selectedIndex].text.toUpperCase()} Â· FIRST TERM 2024/2025`;
}

function printBroadsheet(){
  document.querySelector('.print-header').style.display='block';
  window.print();
  setTimeout(()=>{document.querySelector('.print-header').style.display='none';},1000);
}

// â”€â”€ ANALYSIS â”€â”€
function renderAnalysis(){
  const chartEl=document.getElementById('ca-exam-chart');
  if(chartEl.innerHTML!=='')return;
  chartEl.innerHTML=subjects.map((s,i)=>`
    <div class="bar-group">
      <div class="bar ca" style="height:${subjectAvgCA[i]}%" data-val="CA: ${subjectAvgCA[i]}%"></div>
      <div class="bar exam" style="height:${subjectAvgExam[i]}%" data-val="Exam: ${subjectAvgExam[i]}%"></div>
      <div class="bar-label">${s.substring(0,7)}</div>
    </div>`).join('');

  const strongEl=document.getElementById('strong-subjects');
  const weakEl=document.getElementById('weak-subjects');
  if(strongEl.innerHTML!=='')return;
  subjects.forEach((s,i)=>{
    const avg=((subjectAvgCA[i]+subjectAvgExam[i])/2).toFixed(0);
    const bar=`<div class="h-bar-item"><div class="h-bar-top"><strong>${s}</strong><span>${avg}% avg</span></div><div class="h-bar-track"><div class="h-bar-ca" style="width:${subjectAvgCA[i]}%;"></div></div></div>`;
    if(avg>=65)strongEl.innerHTML+=bar;
    else if(avg<60)weakEl.innerHTML+=bar;
  });

  const ranked=[...studentsData].map(s=>({...s,total:s.ca.reduce((a,c,i)=>a+c+s.exam[i],0),avg:(s.ca.reduce((a,c,i)=>a+c+s.exam[i],0)/subjects.length).toFixed(1)})).sort((a,b)=>b.total-a.total);

  document.getElementById('top-students-analysis').innerHTML=ranked.slice(0,5).map((s,i)=>`
    <div style="display:flex;align-items:center;gap:12px;padding:10px 12px;background:rgba(74,222,128,0.05);border:1px solid rgba(74,222,128,0.15);border-radius:12px;margin-bottom:8px;">
      <div style="width:22px;height:22px;border-radius:50%;background:var(--green-bg);border:1px solid var(--green-b);display:flex;align-items:center;justify-content:center;font-size:0.7rem;font-weight:700;color:var(--green);">${i+1}</div>
      <div style="flex:1;"><div style="font-size:0.85rem;font-weight:600;">${s.name}</div><div style="font-size:0.72rem;color:var(--muted);">${s.reg}</div></div>
      <div style="font-family:'Playfair Display',serif;color:var(--green);font-weight:700;">${s.avg}%</div>
    </div>`).join('');

  document.getElementById('low-students-analysis').innerHTML=ranked.slice(-5).reverse().map(s=>`
    <div style="display:flex;align-items:center;gap:12px;padding:10px 12px;background:rgba(248,113,113,0.05);border:1px solid rgba(248,113,113,0.15);border-radius:12px;margin-bottom:8px;">
      <div style="font-size:1rem;">ğŸ¤</div>
      <div style="flex:1;"><div style="font-size:0.85rem;font-weight:600;">${s.name}</div><div style="font-size:0.72rem;color:var(--muted);">${s.reg}</div></div>
      <div style="font-family:'Playfair Display',serif;color:var(--red);font-weight:700;">${s.avg}%</div>
    </div>`).join('');

  document.getElementById('student-ca-exam-bars').innerHTML=ranked.map(s=>{
    const caP=(s.ca.reduce((a,c)=>a+c,0)/s.ca.length/30*100).toFixed(0);
    const exP=(s.exam.reduce((a,e)=>a+e,0)/s.exam.length/70*100).toFixed(0);
    return`<div class="h-bar-item"><div class="h-bar-top"><strong>${s.name}</strong><span>CA: ${caP}% &nbsp;|&nbsp; Exam: ${exP}%</span></div><div class="h-bar-track" style="height:12px;border-radius:6px;"><div class="h-bar-ca" style="width:${caP/2}%;border-radius:6px 0 0 6px;"></div><div class="h-bar-exam" style="width:${exP/2}%;left:${caP/2}%;border-radius:0 6px 6px 0;"></div></div></div>`;
  }).join('');
}

// â”€â”€ ADMIN PSYCHOMOTOR VIEW â”€â”€
const psychoTraits=['Punctuality','Attentiveness','Neatness','Politeness','Honesty','Sports','Clubs','Creativity','Leadership','Conduct'];
function renderAdminPsycho(){
  const tbody=document.getElementById('admin-psycho-view');
  if(tbody&&tbody.innerHTML!=='')return;
  if(!tbody)return;
  tbody.innerHTML=studentsData.map(s=>`<tr>
    <td style="white-space:nowrap;">${s.name}</td>
    ${psychoTraits.map(()=>`<td style="color:var(--amber);font-weight:700;">3</td>`).join('')}
  </tr>`).join('');
}

function approvePsycho(cls){
  showToast(`Psychomotor for ${cls} approved! Grades will appear on student results.`);
}

// â”€â”€ STUDENTS â”€â”€
function renderStudentTable(){
  const tbody=document.getElementById('student-table-body');
  if(tbody.innerHTML!=='')return;
  studentsData.forEach(s=>{tbody.innerHTML+=`<tr>
    <td style="color:var(--amber-light);font-size:0.78rem;">${s.reg}</td>
    <td style="font-weight:500;">${s.name}</td>
    <td><span class="badge badge-blue">${s.cls}</span></td>
    <td style="color:var(--muted);font-size:0.8rem;">${s.teacher}</td>
    <td><span class="badge badge-green">Active</span></td>
    <td class="actions">
      <button class="btn btn-sm btn-amber" onclick="showToast('Editing...')">Edit</button>
      <button class="btn btn-sm btn-purple" onclick="showToast('Viewing results...')">Results</button>
      <button class="btn btn-sm btn-red" onclick="showToast('Removed')">Remove</button>
    </td></tr>`;});
}

// â”€â”€ STAFF â”€â”€
const staffData=[
  {name:'Mrs. Funke Okonkwo',phone:'08012345678',subjects:'Maths, Further Maths',ct:'JSS 2A'},
  {name:'Mr. Tunde Adeleke', phone:'08023456789',subjects:'English Language',ct:'JSS 1A'},
  {name:'Mrs. Bimpe Fashola',phone:'08034567890',subjects:'Basic Science',ct:'SS 1A'},
  {name:'Mr. Usman Ibrahim', phone:'08045678901',subjects:'Social Studies',ct:'None'},
];
function renderStaffTable(){
  const tbody=document.getElementById('staff-table-body');
  if(tbody.innerHTML!=='')return;
  staffData.forEach(s=>{
    const ct=s.ct!=='None'?`<span class="badge badge-green">âœ… ${s.ct}</span>`:`<span class="badge badge-amber">Not Assigned</span>`;
    tbody.innerHTML+=`<tr>
      <td style="font-weight:500;">${s.name}</td>
      <td style="color:var(--muted);font-size:0.8rem;">${s.phone}</td>
      <td style="font-size:0.8rem;">${s.subjects}</td>
      <td>${ct}</td>
      <td><span class="badge badge-green">Active</span></td>
      <td class="actions">
        <button class="btn btn-sm btn-purple" onclick="showToast('Editing...')">Edit</button>
        <button class="btn btn-sm btn-rose" onclick="showToast('PW reset')">Reset PW</button>
        <button class="btn btn-sm btn-red" onclick="showToast('Removed')">Remove</button>
      </td></tr>`;});
}

// â”€â”€ CLASSES â”€â”€
const classesData=[
  {name:'JSS 1A',students:28,avg:'74%',teacher:'Mr. Adeleke'},
  {name:'JSS 1B',students:26,avg:'68%',teacher:'Mrs. Afolabi'},
  {name:'JSS 2A',students:32,avg:'72%',teacher:'Mrs. Okonkwo'},
  {name:'JSS 2B',students:30,avg:'65%',teacher:'Mr. Ibrahim'},
  {name:'SS 1A', students:22,avg:'69%',teacher:'Mrs. Fashola'},
  {name:'SS 2A', students:20,avg:'66%',teacher:'Not Assigned'},
];
function renderClassGrid(){
  const g=document.getElementById('class-grid');
  if(g.innerHTML!=='')return;
  classesData.forEach(c=>{g.innerHTML+=`<div class="class-card"><h4>${c.name}</h4><div class="cc-meta">ğŸ‘¥ ${c.students} students</div><div class="cc-meta">ğŸ‘©â€ğŸ« ${c.teacher}</div><div class="cc-avg">${c.avg}</div></div>`;});
}

// â”€â”€ SCORES â”€â”€
function renderAdminScores(){
  const tbody=document.getElementById('admin-score-body');
  if(tbody.innerHTML!=='')return;
  studentsData.slice(0,5).forEach(s=>{
    const ca=s.ca[0],ex=s.exam[0],total=ca+ex;
    const g=jssGrade(total),gc=jssGradeClass(total);
    tbody.innerHTML+=`<tr>
      <td style="font-weight:500;">${s.name}</td>
      <td style="color:var(--muted);font-size:0.78rem;">${s.reg}</td>
      <td><input class="score-input" type="number" min="0" max="30" value="${ca}"></td>
      <td><input class="score-input" type="number" min="0" max="70" value="${ex}"></td>
      <td style="font-weight:700;">${total}</td>
      <td><span class="${gc}">${g}</span></td>
      <td><button class="btn btn-sm btn-amber" onclick="showToast('Saved!')">Save</button></td></tr>`;});
}

// â”€â”€ ACTIVITY â”€â”€
function renderActivity(){
  const el=document.getElementById('full-activity');
  if(el.innerHTML!=='')return;
  [{icon:'âœï¸',title:'Mrs. Okonkwo entered Maths scores',sub:'JSS 2A Â· 32 students',time:'2h ago'},
   {icon:'ğŸ§ ',title:'Psychomotor submitted â€” JSS 2A',sub:'Mrs. Okonkwo Â· Awaiting admin approval',time:'Yesterday'},
   {icon:'ğŸ’',title:'New student â€” Taiwo Emmanuel',sub:'JSS 1A Â· AMA/2025/248',time:'5h ago'},
   {icon:'ğŸ”‘',title:'Password reset â€” Adeyemi Aisha',sub:'SMS sent',time:'Yesterday'},
   {icon:'âœ…',title:'Psychomotor approved â€” SS 1A',sub:'By Admin Â· Included in results',time:'2 days ago'},
   {icon:'ğŸ“¢',title:'Notice sent â€” Score Entry Deadline',sub:'All Staff',time:'2 days ago'},
  ].forEach(a=>{el.innerHTML+=`<div class="activity-item"><div class="act-icon">${a.icon}</div><div class="act-text"><strong>${a.title}</strong><span>${a.sub}</span></div><div class="act-time">${a.time}</div></div>`;});
}

// â”€â”€ MODALS + TOAST â”€â”€
function openModal(n){document.getElementById('modal-'+n).classList.add('show');}
function closeModal(n){document.getElementById('modal-'+n).classList.remove('show');}
document.querySelectorAll('.modal').forEach(m=>{m.addEventListener('click',function(e){if(e.target===this)this.classList.remove('show');});});
function showToast(msg){
  const t=document.getElementById('toast');
  t.textContent='âœ… '+msg;t.style.opacity='1';t.style.transform='translateY(0)';
  setTimeout(()=>{t.style.opacity='0';t.style.transform='translateY(10px)';},3000);
}
</script>
</body>
</html>
